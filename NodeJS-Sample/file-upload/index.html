<html>

<head>
    <title>File Uploading Form</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js" ></script>
</head>

<body>
    <h3>File Upload:</h3> Select a file to upload: <br />

    <form id="myform" action="/file_upload" method="POST" enctype="multipart/form-data">
        <input type="file" name="refFile" />
        <input type="submit" value="Upload File" />
    </form>

    <script type="text/javascript">
        $(document).ready(function() {
            $('#myform').on('submit', function(e) {
                e.preventDefault();
                console.log($(this).attr('action'));

                // Create a formdata object and add the files
		var data = new FormData();
		$.each(files, function(key, value)
		{
			data.append(key, value);
		});

        $.ajax({
            url: $(this).attr('action') || window.location.pathname,
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function(data, textStatus, jqXHR)
            {
            	if(typeof data.error === 'undefined')
            	{
            		// Success so call function to process the form
            		submitForm(event, data);
            	}
            	else
            	{
            		// Handle errors here
            		console.log('ERRORS: ' + data.error);
            	}
            },
            error: function(jqXHR, textStatus, errorThrown)
            {
            	// Handle errors here
            	console.log('ERRORS: ' + textStatus);
            	// STOP LOADING SPINNER
            }
        });                
              /*  $.ajax({
                    url: $(this).attr('action') || window.location.pathname,
                    type: "POST",
                    data: $(this).serialize(),
                    success: function(data) {
                    console.log(data);
                        //$("#form_output").html(data);
                    },
                    error: function(jXHR, textStatus, errorThrown) {
                        alert(errorThrown);
                    }
                });*/
            });
        });
    </script>
</body>

</html>
